<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="shop">
	<select id="getList" resultType="shopDto">
		SELECT num,cateNum,name,image,price,cast,hours,location,startdate,enddate,remainCount,tel,seatNum
		FROM shop
		ORDER BY num ASC
	</select>
	<update id="minusCount" parameterType="int">
		UPDATE shop
		SET remainCount=remainCount-1
		WHERE num=#{num}
	</update>

	<select id="getPrice" parameterType="int" resultType="int">
		SELECT price
		FROM shop
		WHERE num=#{num}
	</select>
	<select id="getData" parameterType="int" resultType="ShopDto">
		SELECT *
		FROM
			(SELECT num,name,price,image,cast,hours,location,
				LAG(num, 1, 0) OVER (ORDER BY num DESC) AS prevNum,
				LEAD(num, 1, 0) OVER (ORDER BY num DESC) AS nextNum
			FROM shop
			ORDER BY num DESC)
		WHERE num = #{num}
	</select>
</mapper>












